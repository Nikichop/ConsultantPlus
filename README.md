# Проект: Анализ сессий пользователей в системе Consultant Plus

Проект был создан в рамках тестового задания для собеседования на позицию **Data Engineer** в компании **Consultant Plus**.

## Суть задания

Необходимо проанализировать данные сессий (10 000 файлов) с использованием **Apache Spark** на языке **Scala** и вывести следующую информацию:

1. **Количество поисков документа с идентификатором `ACC_45616` в карточке поиска.**
2. **Количество открытий каждого документа, найденного через быстрый поиск, за каждый день.**

---

## Примеры выполнения

### Результат выполнения `Task1.scala`:
![Результат Task1.scala](https://github.com/Nikichop/ConsultantPlus/blob/master/task1.png)

### Результат выполнения `Task2.scala`:
![Результат Task2.scala](https://github.com/Nikichop/ConsultantPlus/blob/master/task2.png)

---

## Описание данных

Данные представляют собой **тренировочную модель пользовательских сессий** системы **Consultant Plus**. Под сессией понимается последовательность действий пользователя в системе между открытием и закрытием системы. В сессиях обязательно присутствуют события начала и конца сессии: `SESSION_START` и `SESSION_END`. Также в сессиях могут быть следующие события:

- **Быстрый поиск (`QS`)**: Поиск документов через поисковую строку. Характеризуется текстом запроса и списком найденных документов.
- **Карточка поиска (`CARD_SEARCH_START`)**: Поиск документов по различным параметрам. Характеризуется списком указанных параметров (каждый параметр описывается идентификатором и значением) и списком найденных документов.
- **Открытие документа (`DOC_OPEN`)**: Событие открытия документа. Каждое открытие документа должно соответствовать какому-либо поиску.

Каждый документ имеет идентификатор вида `<BASE>_<DOCUMENT NUMBER>`, например: `PGU_13`, `ACC_45614`, `LAW_221940` и т.д.
